{
    "title": "Service Bus Peek Lock Pattern - Renew lock token",
    "description": "This workflow template triggers when a message is available in a Service Bus queue. The workflow gets the message from the queue, locks the message for processing, and renews the lock token until processing completes. The message is deleted from the queue after processing completes. This pattern helps you make sure that the workflow processes the message only once and that the message doesn't get lost if a failure happens during processing.",

    "prerequisites": "Before you can use this template, you need to configure a Service Bus namespace and create a queue. For more information about Service Bus see [Create a new queue on Service Bus](https://learn.microsoft.com/en-us/azure/service-bus-messaging/service-bus-quickstart-portal)",
    "skus": [
        "standard"
    ],
    "kinds": [
        "stateful",
        "stateless"
    ],
    "details": {
        "By": "Microsoft",
        "Type": "Workflow",
        "Trigger": "Event",    
        "Category": "Design Patterns"
    },
    "artifacts": [
        {
            "type": "workflow",
            "file": "workflow.json"
        }
    ],
    "images": {
        "light": "snapshot_light",
        "dark": "snapshot_dark"
    },
    "parameters": [
        {
            "name": "queueName_#workflowname#",
            "displayName": "Queue Name",
            "type": "String",
            "default": "This is the name of the queue from which the message will be fetched.",
            "description": "This is a parameter",
            "required": true
        },
        {
            "name": "messageBatchSize_#workflowname#",
            "displayName": "Message Batch Size",
            "type": "Int",
            "default": "50",
            "description": "This indicates how many messages will be fetched in a single batch.",
            "required": true
        },
        {
            "name": "delayInMinutes_#workflowname#",
            "displayName": "Delay before next token renewal",
            "type": "Int",
            "default": "3",
            "description": "This indicates how long to wait for processing before the lock token is renewed. This value should be smaller than the lock token duration of the queue.",
            "required": true
        }
    ],
    "connections": {
        "serviceBus_#workflowname#": {
            "connectorId": "/serviceProviders/serviceBus",
            "kind": "inapp"
        }
    }
}
